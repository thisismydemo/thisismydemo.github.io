<!DOCTYPE html>
<html class="no-js" lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>My Intune Proactive Remediation Scripts - This Is My Demo</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="http://localhost:1313/post/intune-proactive-remediation-scripts/">
  <meta property="og:site_name" content="This Is My Demo">
  <meta property="og:title" content="My Intune Proactive Remediation Scripts">
  <meta property="og:description" content="I have been working with Intune Proactive Remediation scripts I wanted to share a few that I am working on.If you want to know more about Intune Proactive Remediation you can check on past blogs of mine.
Using Intune’s Proactive Remediation Script Packages to configure clients to retrieve Kerberos tickets for Azure Files.
Intune Proactive Remediation - Check if KB5007253 is installed.
The following scripts are currently in my GitHub repo called ProactiveRemediations.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2023-02-01T14:59:02+00:00">
    <meta property="article:modified_time" content="2023-02-01T17:34:46+00:00">
    <meta property="article:tag" content="PowerShell">
    <meta property="article:tag" content="Proactive Remediation">
    <meta property="article:tag" content="Intune">

		
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="My Intune Proactive Remediation Scripts">
  <meta name="twitter:description" content="I have been working with Intune Proactive Remediation scripts I wanted to share a few that I am working on.If you want to know more about Intune Proactive Remediation you can check on past blogs of mine.
Using Intune’s Proactive Remediation Script Packages to configure clients to retrieve Kerberos tickets for Azure Files.
Intune Proactive Remediation - Check if KB5007253 is installed.
The following scripts are currently in my GitHub repo called ProactiveRemediations.">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="This Is My Demo" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">This Is My Demo</div>
					<div class="logo__tagline">Another blog about clouds... Private Clouds, Public Clouds, Hybrid Clouds, and pretty little fluffy clouds?</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1"></span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">About</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">My Intune Proactive Remediation Scripts</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2023-02-01T14:59:02Z">February 01, 2023</time>
	<time class="meta__text" datetime="2023-02-01T17:34:46Z">(: February 01, 2023)</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/intune-proactive-remediation/" rel="category">Intune Proactive Remediation</a>
	</span>
</div></div>
		</header>
		<div class="content post__content clearfix">
			<p>I have been working with Intune Proactive Remediation scripts I wanted to share a few that I am working on.If you want to know more about Intune Proactive Remediation you can check on past blogs of mine.</p>
<p><a href="https://www.thisismydemo.cloud/post/2023-01-20-using-intunes-proactive-remediation-script-packages-to-configure-clients-to-retrieve-kerberos-tickets-for-azure-files/">Using Intune&rsquo;s Proactive Remediation Script Packages to configure clients to retrieve Kerberos tickets for Azure Files.</a></p>
<p><a href="https://www.thisismydemo.cloud/post/2023-01-31-intunes-proactive-remediations/">Intune Proactive Remediation - Check if KB5007253 is installed.</a></p>
<p>The following scripts are currently in my GitHub repo called <a href="https://github.com/kristopherjturner/ProactiveRemediations">ProactiveRemediations</a>.</p>
<p>As of the time of this blog I have created 5 Proactive Remediation Scripts.</p>
<ol>
<li>CloudKerberosTicketRetrievalEnabled</li>
<li>DriveMappingDetection</li>
<li>EnableLinkedConnections</li>
<li>InstallWIndowsUpdate</li>
<li>RemoveScheduledTask</li>
</ol>
<h3 id="cloudkerberosticketretrievalenabled">CloudKerberosTicketRetrievalEnabled</h3>
<p>This was created to enable client machines for Azure AD Kerberos authentication on the Azure file shares.  It was a simple Registry entry that needed a value added or changed.</p>
<p><em><strong>Detection Script</strong></em></p>
<pre tabindex="0"><code>&lt;#
.DESCRIPTION
	Detects if the registry key CloudKerberosTicketRetrievalEnabled exist and it is enabled.
	If the value set on it is correct and be marked as compiant.  If it is it doesn&#39;t exist  or the value is incorrect
	it will be markd as non-compliant then remediated.

.NOTES
	Author and Edited: Kristopher Turner (InvokeLLC)
#&gt;


$Date = Get-Date -UFormat &#34;%Y-%m-%d_%H-%m-%S&#34;
$LogFileName = &#34;Detect-&#34; + &#34;CloudKerberosTicketRetrievalEnabled-&#34; + $date + &#34;.log&#34;
Start-Transcript -Path $(Join-Path $env:temp $LogFileName)

try {
	if (-NOT (Test-Path -LiteralPath &#34;HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Parameters&#34;)) {
		# Remediate on ext code 1
		Write-Host &#34;Registry key doesn&#39;t exist&#34;
		exit 1
	};
	if ((Get-ItemPropertyValue -LiteralPath &#39;HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Parameters&#39; -Name &#39;CloudKerberosTicketRetrievalEnabled&#39; -ea SilentlyContinue) -eq 1) {
		Write-Host &#34;CloudKerberosTicketRetrievalEnabled exist and is enabled&#34;
		exit 0
	}
 else {
		Write-Host &#34;CloudKerberosTicketRetrievalEnabled doesn&#39;t exist or is not enabled&#34;
		exit 1
	};
}
catch {
	$errMsg = $_.Exception.Message
	Write-Host $errMsg
	exit 1
}

Stop-Transcript
</code></pre><p><em><strong>Remediation Script</strong></em></p>
<pre tabindex="0"><code>&lt;#
.DESCRIPTION
		Remediates and createsthe registry key CloudKerberosTicketRetrievalEnabled and
		assigns the correct value to enable it.


.NOTES
	Author and Edited: Kristopher Turner (InvokeLLC)
#&gt;

$Date = Get-Date -UFormat &#34;%Y-%m-%d_%H-%m-%S&#34;
$LogFileName = &#34;Remediate-&#34; + &#34;CloudKerberosTicketRetrievalEnabled-&#34; + $date + &#34;.log&#34;
Start-Transcript -Path $(Join-Path $env:temp $LogFileName)


#&gt;# Reg2CI (c) 2022 by Roger Zander
if ((Test-Path -LiteralPath &#34;HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Parameters&#34;) -ne $true) { New-Item &#34;HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Parameters&#34; -force -ea SilentlyContinue };
New-ItemProperty -LiteralPath &#39;HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Parameters&#39; -Name &#39;CloudKerberosTicketRetrievalEnabled&#39; -Value 1 -PropertyType DWord -Force -ea SilentlyContinue;


Stop-Transcript
</code></pre><hr>
<h3 id="drivemappingdetection">DriveMappingDetection</h3>
<p>This was a script I used to map an Azure Files drive using Intune.  We needed to do some detection if the drive already existed and if the user could connect to port 445 before the drive could be mapped.</p>
<p><em><strong>Detection Script</strong></em></p>
<pre tabindex="0"><code>&lt;#
.DESCRIPTION
	Detects if user already has Azure File Share mapped.  If detected it will exit script and not run remediation script.
	If not detected it will then detected if user can connect to Azure File Share via port 445. If user can connect via port 445 the remediation
	script will run. If user can&#39;t connect it will exit.


.NOTES
	Author and Edited: Kristopher Turner (InvokeLLC)
	Make sure to change change variables!!!

#&gt;

$ShareName = &#34;&#34; # - Azure File Share
$StorageAccount = &#34;&#34; # - Storage Account


$Date = Get-Date -UFormat &#34;%Y-%m-%d_%H-%m-%S&#34;
$LogFileName = &#34;DriveMapping-&#34; + &#34;Detect-&#34; + $ShareName + &#34;-&#34; + $date + &#34;.log&#34;
Start-Transcript -Path $(Join-Path $env:temp $LogFileName)

$connectTestResult = Test-NetConnection -ComputerName &#34;$storageaccount.file.core.windows.net&#34; -Port 445
$Path = &#34;\\$StorageAccount.file.core.windows.net\$ShareName&#34;


try {
	if ((Get-ItemPropertyValue -LiteralPath &#39;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System&#39; -Name &#39;EnableLinkedConnections&#39; -ea SilentlyContinue) -eq 1) {
	}
	else { 
		Write-Host &#34;EnableLinkedConnection Registry Key Doesn&#39;t Exist.&#34;
		exit 1 
 };
	if (Get-PSDrive | Where-Object { $_.DisplayRoot -eq $path }) { 
		Write-Host &#34;Drive is Mapped&#34;
		exit 0
	}
 else { 
		Write-Host &#34;Drive needs to be mapped&#34;
		exit 1 
 };
	if ($connectTestResult.TcpTestSucceeded) { 
		Write-Host &#34;Connection to storage account via 443 succesful. Script will continue.&#34; 
	} 
	else {
		Write-Error -Message &#34;Unable to reach the Azure storage account via port 445. Check to make sure your organization or ISP is not blocking port 445, or use Azure P2S VPN, Azure S2S VPN, or Express Route to tunnel SMB traffic over a different port.&#34;
		exit 1
	}
}
catch {
	$errMsg = $_.Exception.Message
	Write-Host $errMsg
	exit 1
}

Stop-Transcript
</code></pre><p><em><strong>Remediation Script</strong></em></p>
<pre tabindex="0"><code>&lt;#
.DESCRIPTION
    Remediate script will run if detect script passed.  The script will then find the next available drive letter and map the Azur File share.  
    After which the script will configure a scheduled task to make rue the mapped drive stays mapped.

.NOTES
	Author and Edited: Kristopher Turner (InvokeLLC)
	Make sure to change change variables!!!

#&gt;

$ShareName = &#34;&#34; # - Azure File Name
$DriveLabel = &#34;&#34; # - Drive Label
$StorageAccount = &#34;&#34; # - Storage Account

$Date = Get-Date -UFormat &#34;%Y-%m-%d_%H-%m-%S&#34;
$LogFileName = &#34;DriveMapping-&#34; + &#34;Remediate-&#34; + $ShareName + $date + &#34;.log&#34;
Start-Transcript -Path $(Join-Path $env:temp $LogFileName)

function Test-RunningAsSystem {
    [CmdletBinding()]
    param()
    process {
        return [bool]($(whoami -user) -match &#34;S-1-5-18&#34;)
    }
}

$Path = &#34;\\$StorageAccount.file.core.windows.net\$ShareName&#34;
$ProviderName = Get-WmiObject win32_logicaldisk | select-object ProviderName | where-object { $_.ProviderName -eq &#34;$Path&#34; }
$DriveLetter = (68..90 | ForEach-Object { $L = [char]$_; if ((Get-PSDrive).Name -notContains $L) { $L } })[0]
Write-Host (&#34;$DriveLetter is next available.&#34;)

if ($ProviderName) {
    Write-Host $Path (&#34;already exist.&#34;)
    Write-Host (&#34;Exiting Script&#34;)
    Exit
}
else {
    Write-Host (&#34;Mapped drive will continue.&#34;)
}


$connectTestResult = Test-NetConnection -ComputerName &#34;$storageaccount.file.core.windows.net&#34; -Port 445
if ($connectTestResult.TcpTestSucceeded) {
    Write-Host (&#34;Connection to storage account via 443 succesful. Script will continue.&#34;)
}
else {
    Write-Error -Message &#34;Unable to reach the Azure storage account via port 445. Check to make sure your organization or ISP is not blocking port 445, or use Azure P2S VPN, Azure S2S VPN, or Express Route to tunnel SMB traffic over a different port.&#34;
    Write-Host (&#34;Skipping drive creation due to connectivity.&#34;)
    Exit
}



if (-not (Test-RunningAsSystem)) {

    $psDrives = Get-PSDrive | Where-Object { $_.Provider.Name -eq &#34;FileSystem&#34; -and $_.Root -notin @(&#34;$env:SystemDrive\&#34;, &#34;D:\&#34;) } `
    | Select-Object @{N = &#34;DriveLetter&#34;; E = { $_.Name } }, @{N = &#34;Path&#34;; E = { $_.DisplayRoot } }

    try {
        #check if variable in unc path exists, e.g. for $env:USERNAME -&gt; resolving
        if ($Path -match &#39;\$env:&#39;) {
            $Path = $ExecutionContext.InvokeCommand.ExpandString($Path)
        }

        #if label is null we need to set it to empty in order to avoid error
        if ($null -eq $DriveLabel) {
            $DriveLabel = &#34;&#34;
        }

        $exists = $psDrives | Where-Object { $_.Path -eq $Path -or $_.DriveLetter -eq $DriveLetter }
        $process = $true

        if ($null -ne $exists -and $($exists.Path -eq $Path -and $exists.DriveLetter -eq $DriveLetter )) {
            Write-Output &#34;Drive &#39;$($DriveLetter):\&#39; &#39;$($Path)&#39; already exists with correct Drive Letter and Path&#34;
            $process = $false

        }
        else {
            # Mapped with wrong config -&gt; Delete it
            Get-PSDrive | Where-Object { $_.DisplayRoot -eq $Path -or $_.Name -eq $DriveLetter } | Remove-PSDrive -EA SilentlyContinue
        }

        if ($process) {
            Write-Output &#34;Mapping network drive $($Path)&#34;
            $null = New-PSDrive -PSProvider FileSystem -Name $DriveLetter -Root $Path -Description $DriveLabel -Persist -Scope global -EA SilentlyContinue
				(New-Object -ComObject Shell.Application).NameSpace(&#34;$($DriveLetter):&#34;).Self.Name = $DriveLabel
        }
    }
    catch {
        $available = Test-Path $($Path)
        if (-not $available) {
            Write-Error &#34;Unable to access path &#39;$($Path)&#39; verify permissions and authentication!&#34;
        }
        else {
            Write-Error $_.Exception.Message
            Exit 1
        }
    }


    # Remove unassigned drives
    if ($removeStaleDrives -and $null -ne $psDrives) {
        $diff = Compare-Object -ReferenceObject $driveMappingConfig -DifferenceObject $psDrives -Property &#34;DriveLetter&#34; -PassThru | Where-Object { $_.SideIndicator -eq &#34;=&gt;&#34; }
        foreach ($unassignedDrive in $diff) {
            Write-Warning &#34;Drive &#39;$($unassignedDrive.DriveLetter)&#39; has not been assigned - removing it...&#34;
            Remove-SmbMapping -LocalPath &#34;$($unassignedDrive.DriveLetter):&#34; -Force -UpdateProfile
        }
    }

    # Fix to ensure drives are mapped as persistent!
    $null = Get-ChildItem -Path HKCU:\Network -ErrorAction SilentlyContinue | ForEach-Object { New-ItemProperty -Name ConnectionType -Value 1 -Path $_.PSPath -Force -ErrorAction SilentlyContinue }
}
Stop-Transcript
</code></pre><hr>
<h3 id="enablelinkedconnections">EnableLinkedConnections</h3>
<p>This was created because even though the scripts run as logged in user, Intune still runs the script in an elevated mode.  So mapping drives in an elevated mode won&rsquo;t show up.</p>
<p><em><strong>Detection Script</strong></em></p>
<pre tabindex="0"><code>&lt;#
.DESCRIPTION
	Detects if Registry Key and Value exist.  If True then script will end and compliant.  If false it will end with Not compliant and trigger the remediation script.


.NOTES
	Author and Edited: Kristopher Turner (InvokeLLC)
#&gt;


$Date = Get-Date -UFormat &#34;%Y-%m-%d_%H-%m-%S&#34;
$LogFileName = &#34;Detect-&#34; + &#34;EnableLinkedConnections-&#34; + $date + &#34;.log&#34;
Start-Transcript -Path $(Join-Path $env:temp $LogFileName)

try {
	if (-NOT (Test-Path -LiteralPath &#34;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System&#34;)) {
		# Remediate on exit code 1
		Write-Host &#34;Registry Key Doesn&#39;t Exist.&#34;
		exit 1
	};
	if((Get-ItemPropertyValue -LiteralPath &#39;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System&#39; -Name &#39;EnableLinkedConnections&#39; -ea SilentlyContinue) -eq 1) {
		Write-Host &#34;EnableLinkedConnection exist and is enabled&#34;
		exit 0
	} else { 
		Write-Host &#34;EnableLinkedConnection doesn&#39;t exist&#34;
		exit 1 };
}
catch {
	$errMsg = $_.Exception.Message
	Write-Host $errMsg
	exit 1
}

Stop-Transcript
</code></pre><p><em><strong>Remediation Script</strong></em></p>
<pre tabindex="0"><code>&lt;#
.DESCRIPTION
	Remediates EnableLinkedConnection Registry Value from 0 to 1.


.NOTES
	Author and Edited: Kristopher Turner (InvokeLLC)
#&gt;


$Date = Get-Date -UFormat &#34;%Y-%m-%d_%H-%m-%S&#34;
$LogFileName = &#34;Remediate-&#34; + &#34;EnableLinkedConnections-&#34; + $date + &#34;.log&#34;
Start-Transcript -Path $(Join-Path $env:temp $LogFileName)


if((Test-Path -LiteralPath &#34;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System&#34;) -ne $true) {  New-Item &#34;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System&#34; -force -ea SilentlyContinue };
New-ItemProperty -LiteralPath &#39;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System&#39; -Name &#39;EnableLinkedConnections&#39; -Value 1 -PropertyType DWord -Force -ea SilentlyContinue;


Stop-Transcript
</code></pre><hr>
<h3 id="installwindowsupdate">InstallWIndowsUpdate</h3>
<p>This was created to check if a certain cumulative update was installed.  If not, it would install it. This specific one you can just run the detection script for your reports if needed.</p>
<p><em><strong>Detection Script</strong></em></p>
<pre tabindex="0"><code>&lt;#
.DESCRIPTION
    Detects if the cumulative update KB5007253 - 2021-11 Cumulative Update Preview for Windows 10 is installed.
    If the installed it will marked as compliant.  If it isn&#39;t installed it will be marked as non-compliant then remediated.

.NOTES
    Author and Edited: Kristopher Turner (InvokeLLC)
#&gt;

$Date = Get-Date -UFormat &#34;%Y-%m-%d_%H-%m-%S&#34;
$LogFileName = &#34;Detect-&#34; + &#34;WindowsUpdate-KB5007253-&#34; + $date + &#34;.log&#34;
Start-Transcript -Path $(Join-Path $env:temp $LogFileName)

$update = Get-Hotfix -Id KB5007253
try {
    if ($update -eq $null) {
        # Install the update
        Write-Host &#34;KB5007253 Needed&#34;
        Exit 1
    }
    else {
        # Update is already installed
        Write-Host &#34;KB5007253 update is already installed&#34;
        Exit 0
    };
}
catch {
    $errMsg = $_.Exception.Message
    Write-Host $errMsg
    exit 1
}

Stop-Transcript
</code></pre><p><em><strong>Remediation Script</strong></em></p>
<pre tabindex="0"><code>&lt;#
.DESCRIPTION
    Installs cumulative update KB5007253 - 2021-11 Cumulative Update Preview for Windows 10.

.NOTES
    Author and Edited: Kristopher Turner (InvokeLLC)
#&gt;

$Date = Get-Date -UFormat &#34;%Y-%m-%d_%H-%m-%S&#34;
$LogFileName = &#34;Remediate&#34; + &#34;WindowsUpdate-KB5007253-&#34; + $date + &#34;.log&#34;
Start-Transcript -Path $(Join-Path $env:temp $LogFileName)

# Install Update
Start-Process -FilePath &#34;wusa.exe&#34; -ArgumentList &#34;/quiet /norestart /install /KB4565503&#34; -Wait

Stop-Transcript
</code></pre><hr>
<h3 id="removescheduledtask">RemoveScheduledTask</h3>
<p>My first mapped drive script included a scheduled task that would always check if the drive was mapped. This caused some issues with the same drive being mapped over and over.  So I needed a way to remove these task by checking if it existed then removing it.</p>
<p><em><strong>Detection Script</strong></em></p>
<pre tabindex="0"><code>&lt;#
.DESCRIPTION
	Detects if user a scheduled task is installed.  If not, machine is compliant.


.NOTES
	Author and Edited: Kristopher Turner (InvokeLLC)
	Make sure to change everything in []

#&gt;

$LogFileName = &#34;Detect-IntuneDriveMappingScheduledTask-[taskname]&#34; + $date + &#34;.log&#34;
Start-Transcript -Path $(Join-Path -Path $env:temp -ChildPath &#34;$LogFileName&#34;)
Write-Output &#34;Running as System --&gt; removing scheduled task which will ran on user logon&#34;

try {
    if (Get-ScheduledTask -TaskName &#39;IntuneDriveMapping-[Task Name]&#39;){
        # Remediate on exit code 1
        Write-Host &#34;[Enter Task Name] Task Exist&#34;
        exit 1
    } else {
        Write-Host &#34;[Enter Task Name] does not exits&#34;
        exit 0
    }
}
catch {
	$errMsg = $_.Exception.Message
	Write-Host $errMsg
	exit 1
}

Stop-Transcript
</code></pre><p><em><strong>Remediation Script</strong></em></p>
<pre tabindex="0"><code>&lt;#
.DESCRIPTION
	Remediates a machine by removing the detected scheduled task that is installed.


.NOTES
	Author and Edited: Kristopher Turner (InvokeLLC)
	Make sure to change everything in []

#&gt;


$LogFileName = &#34;Remediate-IntuneDriveMappingScheduledTask-[add task name]-&#34; + $date + &#34;.log&#34;
Start-Transcript -Path $(Join-Path -Path $env:temp -ChildPath &#34;$LogFileName&#34;)
Write-Output &#34;Running as System --&gt; removing scheduled task which will ran on user logon&#34;

Write-Host &#34;Removing [ add task name ] Scheduled Task.&#34;
Unregister-ScheduledTask -TaskName &#39;IntuneDriveMapping-[and task name]&#39; -Confirm:$false


Stop-Transcript
</code></pre><hr>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/powershell/" rel="tag">PowerShell</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/proactive-remediation/" rel="tag">Proactive Remediation</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/intune/" rel="tag">Intune</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>

<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="Kristopher J Turner avatar" src="/img/me.jpg" class="avatar" height="90" width="90">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name"></span>
	</div>
	<div class="authorbox__description">
		Kristopher Turner is a Microsoft MVP in Azure, a Microsoft Certified Trainer (MCT), and a Product Technology Architect at TierPoint, where he focuses on delivering innovative cloud and infrastructure solutions. With expertise spanning Azure Stack HCI, Azure Arc, Kubernetes, and disaster recovery strategies using ASR, Kristopher bridges on-premises and cloud technologies to drive digital transformation. A sought-after speaker and thought leader, he frequently presents on hybrid architectures, cloud-native technologies, and monitoring solutions, sharing insights from his extensive experience in modern IT infrastructure.
	</div>
</div>

<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/post/2023-01-31-intunes-proactive-remediations/" rel="prev">
			<span class="pager__subtitle">«&thinsp;</span>
			<p class="pager__title">Intune Proactive Remediation - Check if KB5007253 is installed.</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/post/2023-02-01-customize-my-windows-terminal-please-/" rel="next">
			<span class="pager__subtitle">&thinsp;»</span>
			<p class="pager__title">Customize My WIndows Terminal Please? </p>
		</a>
	</div>
</nav>


			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<label>
			<input class="widget-search__field" type="search" placeholder="" value="" name="q" aria-label="">
		</label>
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="http://localhost:1313/">
	</form>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title"></h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/post/beyond-cloud-hardware-considerations-part-iii/">Beyond the Cloud: Hardware Considerations - Part III</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/choosing-your-virtualization-platform-2025-licensing-analysis/">Beyond the Cloud: 2025 Virtualization Licensing Guide - Part II</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/capex-subscription-tco-modeling-hyper-azure-local-avs/">Beyond the Cloud: CapEx vs Subscription TCO Analysis - Part I</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/2025-06-06-powerful-practical-proven-why-wsfc-and-hyperv-deserve-a-second-look/">Powerful, Practical, Proven: Why WSFC and Hyper‑V Deserve a Second Look</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/rethinking-virtualization-post-vmware/">Beyond the Cloud: Rethinking Virtualization Post-VMware</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title"></h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/categories/azure/">Azure</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/azure-active-directory/">Azure Active Directory</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/azure-arc/">Azure Arc</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/azure-arc-enabled-kubernetes/">Azure Arc-Enabled Kubernetes</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/azure-arc-enabled-servers/">Azure Arc-Enabled Servers</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/azure-files/">Azure Files</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/azure-local/">Azure Local</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/azure-percept-development-kit/">Azure Percept Development Kit</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/azure-site-recovery/">Azure Site Recovery</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/azure-sphere-development-kit/">Azure Sphere Development Kit</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/azure-stack-hci/">Azure Stack HCI</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/cloud-computing/">Cloud Computing</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/cost-analysis/">Cost Analysis</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/cross-tenant-synchronization/">Cross-Tenant Synchronization</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/dfwsmug/">DFWSMUG</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/entra-permissions-management/">Entra Permissions Management</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/festive-tech-calendar/">Festive Tech Calendar</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/hardware/">Hardware</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/home-assistant/">Home Assistant</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/infrastructure/">Infrastructure</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/intune/">Intune</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/intune-proactive-remediation/">Intune Proactive Remediation</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/licensing/">Licensing</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/microk8s/">MicroK8S</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/microsoft-sentinel/">Microsoft Sentinel</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/virtualization/">Virtualization</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/vision-ai-developer-kit/">Vision AI Developer Kit</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/windows-clustering/">WIndows Clustering</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/windows-server-failover-cluster/">Windows Server Failover Cluster</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/windows-terminal/">Windows Terminal</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title"></h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/ansible/" title="Ansible">Ansible</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/avs/" title="AVS">AVS</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/aws/" title="AWS">AWS</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure/" title="Azure">Azure</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-ad/" title="Azure AD">Azure AD</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-arc/" title="Azure Arc">Azure Arc</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-arc-enabled-data-services/" title="Azure Arc-Enabled Data Services">Azure Arc-Enabled Data Services</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-arc-enabled-kubernetes/" title="Azure Arc-Enabled Kubernetes">Azure Arc-Enabled Kubernetes</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-arc-enabled-servers/" title="Azure Arc-Enabled Servers">Azure Arc-Enabled Servers</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-arc-mas/" title="Azure Arc-Mas">Azure Arc-Mas</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-bastion/" title="Azure Bastion">Azure Bastion</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-devops/" title="Azure DevOps">Azure DevOps</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-files/" title="Azure Files">Azure Files</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-iot/" title="Azure IoT">Azure IoT</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-kubernetes-service/" title="Azure Kubernetes Service">Azure Kubernetes Service</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-local/" title="Azure Local">Azure Local</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-managed-grafana/" title="Azure Managed Grafana">Azure Managed Grafana</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-managed-prometheus/" title="Azure Managed Prometheus">Azure Managed Prometheus</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-monitor/" title="Azure Monitor">Azure Monitor</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-percept/" title="Azure Percept">Azure Percept</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-percept-development-kit/" title="Azure Percept Development Kit">Azure Percept Development Kit</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-site-recovery/" title="Azure Site Recovery">Azure Site Recovery</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-sphere/" title="Azure Sphere">Azure Sphere</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-sphere-development-kit/" title="Azure Sphere Development Kit">Azure Sphere Development Kit</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-stack-hci/" title="Azure Stack HCI">Azure Stack HCI</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/azure-vmware-solution/" title="Azure VMware Solution">Azure VMware Solution</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cloud-family/" title="Cloud Family">Cloud Family</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/containers-insights/" title="Containers Insights">Containers Insights</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cost-analysis/" title="Cost Analysis">Cost Analysis</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cost-optimization/" title="Cost Optimization">Cost Optimization</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cross-tenant-synchronization/" title="Cross-Tenant Synchronization">Cross-Tenant Synchronization</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/dell-apex/" title="Dell APEX">Dell APEX</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/dfwsmug/" title="DFWSMUG">DFWSMUG</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/endpoint-management/" title="Endpoint Management">Endpoint Management</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/entra-permissions-management/" title="Entra Permissions Management">Entra Permissions Management</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/festive-tech-calendar/" title="Festive Tech Calendar">Festive Tech Calendar</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/freshservice/" title="FreshService">FreshService</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/front-matter/" title="Front Matter">Front Matter</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/github/" title="GitHub">GitHub</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/github-pages/" title="GitHub Pages">GitHub Pages</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/google-cloud-platform/" title="Google Cloud Platform">Google Cloud Platform</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/hardware/" title="Hardware">Hardware</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/home-assistant/" title="Home Assistant">Home Assistant</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/home-automation/" title="Home Automation">Home Automation</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/hugo/" title="Hugo">Hugo</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/hyper-v/" title="Hyper-V">Hyper-V</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/infrastructure/" title="Infrastructure">Infrastructure</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/intune/" title="Intune">Intune</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/iot-edge/" title="Iot Edge">Iot Edge</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/kubernetes/" title="Kubernetes">Kubernetes</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/licensing/" title="Licensing">Licensing</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/linux/" title="Linux">Linux</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/maas/" title="MaaS">MaaS</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/microsk8s/" title="MicrosK8S">MicrosK8S</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/microsoft/" title="Microsoft">Microsoft</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/microsoft-entra/" title="Microsoft Entra">Microsoft Entra</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/microsoft-sentinel/" title="Microsoft Sentinel">Microsoft Sentinel</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/multicloud-connector-enabled-by-azure-arc/" title="Multicloud Connector Enabled by Azure Arc">Multicloud Connector Enabled by Azure Arc</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/permissions-management/" title="Permissions Management">Permissions Management</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/poractive-remediation/" title="Poractive Remediation">Poractive Remediation</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/powershell/" title="PowerShell">PowerShell</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/proactive-remediation/" title="Proactive Remediation">Proactive Remediation</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/rdp/" title="RDP">RDP</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/san/" title="SAN">SAN</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/scvmm/" title="SCVMM">SCVMM</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ssh/" title="SSH">SSH</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/storage/" title="Storage">Storage</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/tco/" title="TCO">TCO</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/terraform/" title="Terraform">Terraform</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/the-festive-tech-calendar/" title="The Festive Tech Calendar">The Festive Tech Calendar</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/the-microsoft-425show/" title="The Microsoft 425Show">The Microsoft 425Show</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/validated-nodes/" title="Validated Nodes">Validated Nodes</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/virtualization/" title="Virtualization">Virtualization</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vision-ai-developer-kit/" title="Vision AI Developer Kit">Vision AI Developer Kit</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vmware/" title="VMware">VMware</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vmware-cloud-foundation/" title="VMware Cloud Foundation">VMware Cloud Foundation</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/vmware-vsphere/" title="VMWare VSphere">VMWare VSphere</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/wac/" title="WAC">WAC</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/windows-admin-center/" title="WIndows Admin Center">WIndows Admin Center</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/windows-server/" title="Windows Server">Windows Server</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/windows-server-2025/" title="Windows Server 2025">Windows Server 2025</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/windows-server-failover-cluster/" title="Windows Server Failover Cluster">Windows Server Failover Cluster</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/windows-terminal/" title="Windows Terminal">Windows Terminal</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/wsfc/" title="WSFC">WSFC</a>
	</div>
</div>
<div class="widget-social widget">
	<h4 class="widget-social__title widget__title"></h4>
	<div class="widget-social__content widget__content">
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="LinkedIn" rel="noopener noreferrer" href="https://linkedin.com/in/KristopherJTurner" target="_blank">
				<svg class="widget-social__link-icon icon icon-linkedin" width="24" height="24" viewBox="0 0 352 352"><path d="M0,40v272c0,21.9,18.1,40,40,40h272c21.9,0,40-18.1,40-40V40c0-21.9-18.1-40-40-40H40C18.1,0,0,18.1,0,40z M312,32 c4.6,0,8,3.4,8,8v272c0,4.6-3.4,8-8,8H40c-4.6,0-8-3.4-8-8V40c0-4.6,3.4-8,8-8H312z M59.5,87c0,15.2,12.3,27.5,27.5,27.5 c15.2,0,27.5-12.3,27.5-27.5c0-15.2-12.3-27.5-27.5-27.5C71.8,59.5,59.5,71.8,59.5,87z M187,157h-1v-21h-45v152h47v-75 c0-19.8,3.9-39,28.5-39c24.2,0,24.5,22.4,24.5,40v74h47v-83.5c0-40.9-8.7-72-56.5-72C208.5,132.5,193.3,145.1,187,157z M64,288h47.5 V136H64V288z"/></svg>
				<span>LinkedIn</span>
			</a>
		</div>
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="GitHub" rel="noopener noreferrer" href="https://github.com/thisismydemo" target="_blank">
				<svg class="widget-social__link-icon icon icon-github" width="24" height="24" viewBox="0 0 384 374"><path d="m192 0c-106.1 0-192 85.8-192 191.7 0 84.7 55 156.6 131.3 181.9 9.6 1.8 13.1-4.2 13.1-9.2 0-4.6-.2-16.6-.3-32.6-53.4 11.6-64.7-25.7-64.7-25.7-8.7-22.1-21.3-28-21.3-28-17.4-11.9 1.3-11.6 1.3-11.6 19.3 1.4 29.4 19.8 29.4 19.8 17.1 29.3 44.9 20.8 55.9 15.9 1.7-12.4 6.7-20.8 12.2-25.6-42.6-4.8-87.5-21.3-87.5-94.8 0-20.9 7.5-38 19.8-51.4-2-4.9-8.6-24.3 1.9-50.7 0 0 16.1-5.2 52.8 19.7 15.3-4.2 31.7-6.4 48.1-6.5 16.3.1 32.7 2.2 48.1 6.5 36.7-24.8 52.8-19.7 52.8-19.7 10.5 26.4 3.9 45.9 1.9 50.7 12.3 13.4 19.7 30.5 19.7 51.4 0 73.7-44.9 89.9-87.7 94.6 6.9 5.9 13 17.6 13 35.5 0 25.6-.2 46.3-.2 52.6 0 5.1 3.5 11.1 13.2 9.2 76.2-25.5 131.2-97.3 131.2-182 0-105.9-86-191.7-192-191.7z"/></svg>
				<span>GitHub</span>
			</a>
		</div>

		
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2025 This Is My Demo.
			<span class="footer__copyright-credits"></span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>